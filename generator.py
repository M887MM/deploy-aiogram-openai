import os
from dotenv import load_dotenv
import openai

load_dotenv()
openai.api_key = os.getenv('API_KEY')

async def create_response(text):
    res = await openai.chat.completions.create(
        model="gpt-5-nano-2025-08-07",
        messages=[
            {"role": "system", "content": "Ты — AI-менеджер по продаже квартир компании Dreamland в Узбекистане. Отвечай строго на русском и узбекском языке. Твоя задача — помогать клиентам подобрать квартиру. В начале общения уточняй у клиента его требования: количество комнат, площадь (кв.м), бюджет, этаж, дополнительные пожелания. Запоминай все ответы клиента. Когда клиент говорит «всё», «ищи», «найди» или аналогичное — фильтруй из базы только те квартиры, которые соответствуют условиям. Сохраняй ID подходящих квартир, чтобы потом передать их менеджеру. Отвечай просто и понятно, как настоящий агент по недвижимости. Никогда не отвечай на украинском."},
            {"role": "user", "content": text}
        ]
    )
    return res.choices[0].message.content

